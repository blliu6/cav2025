include("utils/util.jl")
include("utils/newtonUpdate.jl")
include("utils/rationalSOS.jl")

X = nothing
eig_tol = 1e-4
tol = 1e-50


function solve(n, X, f, Q, mono,newton)
    
    Q = round.(Q, digits=7)
    rQ = symplify_rational.(Q)

    model = nothing
    if !newton
        model = rational_SOS(f, 1, 0, mono, rQ)
    else
        update_Q = newton_refine_update(f, mono, Q, eig_tol, 550, tol, X)
        Q_res = symplify_rational.(update_Q*update_Q')
        model = rational_SOS(f, 1, 0, mono, Q_res)
    end
    
    SOSrational_time, coeffs, terms = model[2:end]
    
    @show expand(f-(coeffs' * terms.^2))

    data = Dict(
        "n" => n,
        "expression" => f,
        "coeff" => join([string(c) for c in coeffs], ","),
        "term" => join([string(t) for t in terms], ","),
        "SOSrational_time" => SOSrational_time,
        "SOS_expression" => string(coeffs' * terms.^2)
    )

    # save("src/output/data.json", data)    
end

n = 4
@Symbolics.variables X[1:n]

#C11
# init
## Multiplier-4
P0 = 30129*X[1]^2//500 + 40679*X[1]*X[2]//10000 + 8917*X[1]*X[3]//2000 - 96681*X[1]*X[4]//10000 + 7913*X[1]//1250 + 7687*X[2]^2//125 + 22769*X[2]*X[3]//5000 - 19777*X[2]*X[4]//2000 - 16687*X[2]//5000 + 31013*X[3]^2//500 - 10121*X[3]*X[4]//1000 - 25329*X[3]//5000 + 69323*X[4]^2//1000 + 3983*X[4]//100 + 57557//1000
M0 = [1, X[4], X[3], X[2], X[1]]
Q0 = [57.55749780959443 19.918693004750043 -2.522649672224371 -1.6803235932645284 3.1673826116757393;
 19.918693004750043 69.32494765559473 -5.067476204224025 -4.923439668000477 -4.826816476537903;
 -2.522649672224371 -5.067476204224025 62.02613798386622 2.270951584865316 2.2384178299780837;
 -1.6803235932645284 -4.923439668000477 2.270951584865316 61.49297850119652 2.0074655807493316;
 3.1673826116757393 -4.826816476537903 2.2384178299780837 2.0074655807493316 60.255816169877306;
]
solve(n, X, P0, Q0, M0, true)
## Multiplier-3
P1 = 28929*X[1]^2//500 + 31967*X[1]*X[2]//10000 - 10169*X[1]*X[3]//1000 - 3269*X[1]*X[4]//2500 + 14997*X[1]//10000 + 12137*X[2]^2//200 - 2581*X[2]*X[3]//250 + 94*X[2]*X[4]//25 + 10367*X[2]//2000 + 68483*X[3]^2//1000 - 11461*X[3]*X[4]//1000 + 8643*X[3]//200 + 5829*X[4]^2//100 - 5793*X[4]//2500 + 68159//1000
M1 = [1, X[4], X[3], X[2], X[1]]
Q1 = [68.15884988063462 -1.1822227908386007 21.581866432710694 2.6105169609386727 0.7501269605035108;
 -1.1822227908386007 58.29029671851798 -5.756686492572074 1.8981450355073899 -0.6798126853464238;
 21.581866432710694 -5.756686492572074 68.47062684506803 -5.16356910426178 -5.099432425342997;
 2.6105169609386727 1.8981450355073899 -5.16356910426178 60.68826228128902 1.5997307004406904;
 0.7501269605035108 -0.6798126853464238 -5.099432425342997 1.5997307004406904 57.86170396199756;
]
solve(n, X, P1, Q1, M1, true)
## Multiplier-2
P2 = 14687*X[1]^2//250 - 47759*X[1]*X[2]//5000 + 18887*X[1]*X[3]//5000 - 47279*X[1]*X[4]//100000 + 7559*X[1]//2000 + 8686*X[2]^2//125 - 5411*X[2]*X[3]//500 - 274*X[2]*X[4]//25 + 22393*X[2]//500 + 2449*X[3]^2//40 + 11259*X[3]*X[4]//2500 + 23591*X[3]//5000 + 14789*X[4]^2//250 + 6793*X[4]//50000 + 13491//200
M2 = [1, X[4], X[3], X[2], X[1]]
Q2 = [67.45530273369472 0.05908468718478467 2.3764133216644607 22.370079308594597 1.8868254653599865;
 0.05908468718478467 59.15585694396515 2.23058027140692 -5.458183334394443 -0.21516016988240205;
 2.3764133216644607 2.23058027140692 61.22418345930302 -5.4109617138298125 1.9110242355372578;
 22.370079308594597 -5.458183334394443 -5.4109617138298125 69.46949832303696 -4.789052376330724;
 1.8868254653599865 -0.21516016988240205 1.9110242355372578 -4.789052376330724 58.7505672869313;
]
solve(n, X, P2, Q2, M2, true)
## Total Decomposition
P3 = 345919*X[1]^4//5000 - 124413*X[1]^3*X[2]//10000 - 16219*X[1]^3*X[3]//1250 - 17517*X[1]^3*X[4]//1250 - 248279*X[1]^3//2500 + 120401*X[1]^2*X[2]^2//1000 + 36211*X[1]^2*X[2]*X[3]//12500 + 8776*X[1]^2*X[2]*X[4]//3125 - 240149*X[1]^2*X[2]//2500 + 14982*X[1]^2*X[3]^2//125 + 32241*X[1]^2*X[3]*X[4]//10000 - 189741*X[1]^2*X[3]//2000 + 119691*X[1]^2*X[4]^2//1000 - 454593*X[1]^2*X[4]//5000 + 85183*X[1]^2//500 - 191157*X[1]*X[2]^3//20000 + 380081*X[1]*X[2]^2*X[3]//100000 - 222249*X[1]*X[2]^2*X[4]//500000 - 2506*X[1]*X[2]^2//25 + 320003*X[1]*X[2]*X[3]^2//100000 - 226323*X[1]*X[2]*X[3]*X[4]//10000000 - 100421*X[1]*X[2]*X[3]//5000 + 25011*X[1]*X[2]*X[4]^2//6250 - 32609*X[1]*X[2]*X[4]//2500 - 15424*X[1]*X[2]//625 - 10263*X[1]*X[3]^3//1000 - 17339*X[1]*X[3]^2*X[4]//12500 - 51131*X[1]*X[3]^2//500 + 13907*X[1]*X[3]*X[4]^2//3125 - 63063*X[1]*X[3]*X[4]//5000 - 437857*X[1]*X[3]//10000 - 243687*X[1]*X[4]^3//25000 - 232767*X[1]*X[4]^2//2500 - 479441*X[1]*X[4]//10000 - 23797*X[1]//200 + 69503*X[2]^4//1000 - 107453*X[2]^3*X[3]//10000 - 1354*X[2]^3*X[4]//125 - 118003*X[2]^3//1250 + 60967*X[2]^2*X[3]^2//500 + 111289*X[2]^2*X[3]*X[4]//25000 - 189967*X[2]^2*X[3]//2000 + 60331*X[2]^2*X[4]^2//500 - 50441*X[2]^2*X[4]//500 + 241999*X[2]^2//1000 - 51907*X[2]*X[3]^3//5000 + 384079*X[2]*X[3]^2*X[4]//100000 - 1543*X[2]*X[3]^2//16 + 227881*X[2]*X[3]*X[4]^2//50000 - 258711*X[2]*X[3]*X[4]//10000 + 950133*X[2]*X[3]//10000 - 987181*X[2]*X[4]^3//100000 - 25509*X[2]*X[4]^2//250 - 22331*X[2]*X[4]//500 + 140031*X[2]//1000 + 684527*X[3]^4//10000 - 28753*X[3]^3*X[4]//2500 - 233927*X[3]^3//2500 + 120301*X[3]^2*X[4]^2//1000 - 12942*X[3]^2*X[4]//125 + 238423*X[3]^2//1000 - 254*X[3]*X[4]^3//25 - 2532*X[3]*X[4]^2//25 - 640261*X[3]*X[4]//10000 + 161891*X[3]//1000 + 43317*X[4]^4//625 - 988157*X[4]^3//10000 + 13109*X[4]^2//100 - 866021*X[4]//10000 + 404703//1000
M3 = [1, X[4], X[3], X[2], X[1], X[4]^2, X[3]*X[4], X[2]*X[4], X[1]*X[4], X[3]^2, X[2]*X[3], X[1]*X[3], X[2]^2, X[1]*X[2], X[1]^2]
Q3 = [404.70335678747335 -43.37653691302839 80.77483826460453 70.16524716832953 -59.51957237416746 -11.120860989307195 -52.9496342687899 -46.28978582770364 -55.766277299836226 20.04056296183251 -24.2971733507639 -43.9975289157797 23.15224736144227 -37.753475757202374 4.217448887460888;
 -43.37653691302839 152.96783619495204 20.978197371884566 23.77359929935923 31.843904510779737 -49.40625465084449 -15.82134280361906 -15.96559940496744 -21.18195076580283 -18.964045824829675 7.392074047303365 4.517767424950743 -20.126408977530065 4.000287649423067 -24.898995085662666;
 80.77483826460453 20.978197371884566 197.8800480669172 71.84734062660014 22.15601043780645 -34.85665117867533 -32.73094196473121 -9.857069240297822 -17.771025293988576 -46.8887604123576 -25.41069682256278 -30.19856608936132 -22.054767301285224 -8.530140905509011 -31.267966696333293;
 70.16524716832953 23.77359929935923 71.84734062660014 195.945423080874 25.24398127727133 -35.02370179626147 -10.334358590565053 -30.391118167692888 -16.662041733582257 -22.87583146727818 -25.4351582306797 -9.13953178677802 -47.099419014442944 -28.091349893976755 -31.723970236114994;
 -59.51957237416746 31.843904510779737 22.15601043780645 25.24398127727133 162.2436140773225 -25.34347661571427 7.010310633294379 6.24478912187945 -20.52406891981471 -20.783981852008 7.6881433198080185 -16.09523471544292 -22.027159613833756 -16.30648985455973 -49.646129407112035;
 -11.120860989307195 -49.40625465084449 -34.85665117867533 -35.02370179626147 -25.34347661571427 69.32494765559393 -5.067476204224103 -4.923439668000466 -4.8268164765376 13.5888080246151 -1.0762840441077945 1.2586071547818454 13.982292411061227 1.2972074252607457 15.988440185550944;
 -52.9496342687899 -15.82134280361906 -32.73094196473121 -10.334358590565053 7.010310633294379 -5.067476204224103 93.13881865315413 3.347235628973087 0.9798106751962113 -5.75668649257202 1.4815836119114916 0.34992530679761036 0.2852058502581396 1.512076125386762 0.6238204842741918;
 -46.28978582770364 -15.96559940496744 -9.857069240297822 -30.391118167692888 6.24478912187945 -4.923439668000466 3.347235628973087 92.68425062303908 0.7102581554885633 0.41656142359595805 1.945374421148716 1.6022737401934297 -5.458183334394459 0.4099630984475851 0.8353991788811276;
 -55.766277299836226 -21.18195076580283 -17.771025293988576 -16.662041733582257 -20.52406891981471 -4.8268164765376 0.9798106751962113 0.7102581554885633 87.6253787450423 -1.0297379921438252 -3.1143498655801194 0.9390479889656917 -0.6251232683299645 0.5807778913918112 -7.052629006877094;
 20.04056296183251 -18.964045824829675 -46.8887604123576 -22.87583146727818 -20.783981852008 13.5888080246151 -5.75668649257202 0.41656142359595805 -1.0297379921438252 68.4706268450683 -5.163569104261787 -5.099432425342957 14.49630900219605 0.7350194942303824 14.17146911414311;
 -24.2971733507639 7.392074047303365 -25.41069682256278 -25.4351582306797 7.6881433198080185 -1.0762840441077945 1.4815836119114916 1.945374421148716 -3.1143498655801194 -5.163569104261787 92.91982773620032 0.8647112062102612 -5.410961713829901 1.2670647257314653 -0.8712597221337522;
 -43.9975289157797 4.517767424950743 -30.19856608936132 -9.13953178677802 -16.09523471544292 1.2586071547818454 0.34992530679761036 1.6022737401934297 0.9390479889656917 -5.099432425342957 0.8647112062102612 91.45030548627001 0.6439595098057198 2.3512694723954297 -6.530965341693329;
 23.15224736144227 -20.126408977530065 -22.054767301285224 -47.099419014442944 -22.027159613833756 13.982292411061227 0.2852058502581396 -5.458183334394459 -0.6251232683299645 14.49630900219605 -5.410961713829901 0.6439595098057198 69.46949832303689 -4.789052376330602 14.60182587921679;
 -37.753475757202374 4.000287649423067 -8.530140905509011 -28.091349893976755 -16.30648985455973 1.2972074252607457 1.512076125386762 0.4099630984475851 0.5807778913918112 0.7350194942303824 1.2670647257314653 2.3512694723954297 -4.789052376330602 91.13035525432903 -6.207603263720699;
 4.217448887460888 -24.898995085662666 -31.267966696333293 -31.723970236114994 -49.646129407112035 15.988440185550944 0.6238204842741918 0.8353991788811276 -7.052629006877094 14.17146911414311 -0.8712597221337522 -6.530965341693329 14.60182587921679 -6.207603263720699 69.14952857487225;
]
solve(n, X, P3, Q3, M3, true)
## Multiplier-1
P4 = 69153*X[1]^2//1000 - 6189*X[1]*X[2]//500 - 13101*X[1]*X[3]//1000 - 1409*X[1]*X[4]//100 + 39019*X[1]//1000 + 61581*X[2]^2//1000 + 1181*X[2]*X[3]//400 + 28031*X[2]*X[4]//10000 - 33511*X[2]//10000 + 6193*X[3]^2//100 + 31391*X[3]*X[4]//10000 - 50793*X[3]//10000 + 29673*X[4]^2//500 + 14051*X[4]//10000 + 54039//1000
M4 = [1, X[4], X[3], X[2], X[1]]
Q4 = [54.03851257212718 0.7274941506467887 -2.563428133164908 -1.6950993311847513 19.50339916776032;
 0.7274941506467887 59.34644294626787 1.5628684732398495 1.416177070273001 -7.052629006877171;
 -2.563428133164908 1.5628684732398495 61.931539752558976 1.4800097502616567 -6.530965341693144;
 -1.6950993311847513 1.416177070273001 1.4800097502616567 61.58343972583203 -6.20760326372072;
 19.50339916776032 -7.052629006877171 -6.530965341693144 -6.20760326372072 69.14952857487165;
]
solve(n, X, P4, Q4, M4, true)
# unsafe
## Multiplier-4
P5 = 1151*X[1]^2//100 + 7759*X[1]*X[2]//2500 + 12221*X[1]*X[3]//5000 - 1621*X[1]*X[4]//1250 + 74953*X[1]//100000 + 7713*X[2]^2//500 + 519*X[2]*X[3]//50 - 61769*X[2]*X[4]//10000 + 1254*X[2]//125 + 15161*X[3]^2//1000 - 341*X[3]*X[4]//50 + 2123*X[3]//200 + 1719*X[4]^2//100 - 6921*X[4]//250 + 10407//500
M5 = [1, X[4], X[3], X[2], X[1]]
Q5 = [20.81414885750591 -13.851539402719924 5.301459221928683 5.020594519831975 0.37812339373582765;
 -13.851539402719924 17.20320894293071 -3.4073210552967703 -3.0931176219734167 -0.6506247226463423;
 5.301459221928683 -3.4073210552967703 15.158239176297728 5.183032360049538 1.2227616440303846;
 5.020594519831975 -3.0931176219734167 5.183032360049538 15.424483424575389 1.5544635984835788;
 0.37812339373582765 -0.6506247226463423 1.2227616440303846 1.5544635984835788 11.511034521219553;
]
solve(n, X, P5, Q5, M5, true)
## Multiplier-3
P6 = 11669*X[1]^2//1000 + 19341*X[1]*X[2]//50000 - 1199*X[1]*X[3]//500 + 27921*X[1]*X[4]//10000 - 478*X[1]//125 + 6593*X[2]^2//500 - 19377*X[2]*X[3]//5000 + 5719*X[2]*X[4]//125000 + 3161*X[2]//250 + 6507*X[3]^2//500 - 1261*X[3]*X[4]//400 - 15423*X[3]//1000 + 1057*X[4]^2//100 - 5211*X[4]//2500 + 5431//250
M6 = [1, X[4], X[3], X[2], X[1]]
Q6 = [21.724449128888438 -1.0350341399898058 -7.70772616891079 6.331978085468485 -1.9010515422427616;
 -1.0350341399898058 10.569531431112697 -1.5756072035489144 0.02614864341785162 1.3987747126443064;
 -7.70772616891079 -1.5756072035489144 13.010560980947016 -1.9369992691375306 -1.2016219312539518;
 6.331978085468485 0.02614864341785162 -1.9369992691375306 13.192159046627696 0.19873514474350848;
 -1.9010515422427616 1.3987747126443064 -1.2016219312539518 0.19873514474350848 11.66785892955261;
]
solve(n, X, P6, Q6, M6, true)
## Multiplier-2
P7 = 11751*X[1]^2//1000 - 35917*X[1]*X[2]//50000 + 93363*X[1]*X[3]//100000 + 3437*X[1]*X[4]//1250 - 8891*X[1]//2500 + 364*X[2]^2//25 - 4961*X[2]*X[3]//2500 - 159*X[2]*X[4]//80 - 2274*X[2]//125 + 2891*X[3]^2//200 + 14693*X[3]*X[4]//50000 + 12811*X[3]//1000 + 2103*X[4]^2//200 - 8009*X[4]//5000 + 556//25
M7 = [1, X[4], X[3], X[2], X[1]]
Q7 = [22.23976352731065 -0.8013675269119704 6.394827180062366 -9.105539786491647 -1.774720771291723;
 -0.8013675269119704 10.514420638419269 0.14220922101784117 -0.9936792465780132 1.373339096204285;
 6.394827180062366 0.14220922101784117 14.447672851527548 -0.9917436477383629 0.4685773383940981;
 -9.105539786491647 -0.9936792465780132 -0.9917436477383629 14.567845226015494 -0.3635594623890288;
 -1.774720771291723 1.373339096204285 0.4685773383940981 -0.3635594623890288 11.751348775252362;
]
solve(n, X, P7, Q7, M7, true)
## Total Decomposition
P8 = 8207*X[1]^4//500 - 85891*X[1]^3*X[2]//10000 - 448959*X[1]^3*X[3]//50000 - 171479*X[1]^3*X[4]//50000 + 200559*X[1]^3//5000 + 247941*X[1]^2*X[2]^2//10000 + 74763*X[1]^2*X[2]*X[3]//12500 + 332603*X[1]^2*X[2]*X[4]//1000000 + 48753*X[1]^2*X[2]//2000 + 123301*X[1]^2*X[3]^2//5000 - 51319*X[1]^2*X[3]*X[4]//500000 + 57181*X[1]^2*X[3]//2500 + 54157*X[1]^2*X[4]^2//2500 + 356197*X[1]^2*X[4]//10000 + 52003*X[1]^2//500 - 87309*X[1]*X[2]^3//125000 + 476389*X[1]*X[2]^2*X[3]//500000 + 34223*X[1]*X[2]^2*X[4]//12500 + 91591*X[1]*X[2]^2//2000 + 194641*X[1]*X[2]*X[3]^2//500000 - 3669*X[1]*X[2]*X[3]*X[4]//78125 + 36599*X[1]*X[2]*X[3]//1250 + 19277*X[1]*X[2]*X[4]^2//6250 + 15504*X[1]*X[2]*X[4]//625 + 14771*X[1]*X[2]//625 - 9651*X[1]*X[3]^3//4000 + 278959*X[1]*X[3]^2*X[4]//100000 + 77027*X[1]*X[3]^2//2000 + 48239*X[1]*X[3]*X[4]^2//20000 + 102219*X[1]*X[3]*X[4]//5000 + 422269*X[1]*X[3]//10000 - 127039*X[1]*X[4]^3//100000 + 22632*X[1]*X[4]^2//625 + 20258*X[1]*X[4]//625 + 205903*X[1]//100000 + 145747*X[2]^4//10000 - 49173*X[2]^3*X[3]//25000 - 198213*X[2]^3*X[4]//100000 + 40137*X[2]^3//1000 + 276313*X[2]^2*X[3]^2//10000 + 28369*X[2]^2*X[3]*X[4]//125000 + 23057*X[2]^2*X[3]//400 + 259269*X[2]^2*X[4]^2//10000 + 521023*X[2]^2*X[4]//10000 + 908907*X[2]^2//10000 - 194079*X[2]*X[3]^3//50000 + 216179*X[2]*X[3]^2*X[4]//5000000 + 550197*X[2]*X[3]^2//10000 + 12947*X[2]*X[3]*X[4]^2//1250 + 1709*X[2]*X[3]*X[4]//40 + 170201*X[2]*X[3]//10000 - 77303*X[2]*X[4]^3//12500 + 272719*X[2]*X[4]^2//10000 + 450139*X[2]*X[4]//10000 - 914649*X[2]//10000 + 64981*X[3]^4//5000 - 316601*X[3]^3*X[4]//100000 + 36551*X[3]^3//1000 + 257283*X[3]^2*X[4]^2//10000 + 458683*X[3]^2*X[4]//10000 + 107757*X[3]^2//1000 - 679169*X[3]*X[4]^3//100000 + 128617*X[3]*X[4]^2//5000 + 650053*X[3]*X[4]//10000 - 105473*X[3]//1000 + 8603*X[4]^4//500 + 82251*X[4]^3//2000 + 127749*X[4]^2//1000 - 23693*X[4]//1000 + 12876//125
M8 = [1, X[4], X[3], X[2], X[1], X[4]^2, X[3]*X[4], X[2]*X[4], X[1]*X[4], X[3]^2, X[2]*X[3], X[1]*X[3], X[2]^2, X[1]*X[2], X[1]^2]
Q8 = [103.00812022180082 -11.813786712803573 -52.73120107008327 -45.74146781551142 1.0799030164006025 7.424216520684876 -9.409990408404276 -11.674328278829252 -8.584910593648367 -3.6149865536639396 -23.821357080791458 -7.850214422869778 -5.834539862416373 -11.084929510045262 5.492018685253233;
 -11.813786712803573 112.90530652011944 41.80111034651863 34.08418555099886 24.799263653505662 20.554879508531332 9.327405865607378 10.964846255253542 12.226923148551275 9.693295430388714 9.994164280782872 1.4860751877588405 11.480052609205849 3.7036112480402683 7.863070744894561;
 -52.73120107008327 41.80111034651863 114.92563235385381 32.25128995405953 28.961386598062912 3.4838322211723276 13.285720683690608 7.395491705487934 8.232326525855513 18.3133965684684 22.299659090513515 11.776459315169292 9.103892786510723 6.642551502337226 5.123264411125625;
 -45.74146781551142 34.08418555099886 32.25128995405953 102.61699789089107 22.929763733827905 2.712119311506735 4.015905549605396 14.59283052764097 6.812540451286797 5.179668251693076 19.708278563930865 2.294139294813133 20.030151533851793 13.749375777499019 4.022492474131356;
 1.0799030164006025 24.799263653505662 28.961386598062912 22.929763733827905 93.13983823802185 5.853093030507052 0.5652803470167225 1.8905283340590437 9.935797243414894 7.493177619716803 5.719999867763334 6.27995263027067 9.101525048483031 8.186414646512766 20.107392850751552;
 7.424216520684876 20.554879508531332 3.4838322211723276 2.712119311506735 5.853093030507052 17.20320894292978 -3.4073210552970394 -3.093117621972404 -0.65062472264608 1.878765218782392 1.1859659510153606 0.26300427106387203 1.9956174416566985 0.41418763132615416 1.5718501896477206;
 -9.409990408404276 9.327405865607378 13.285720683690608 4.015905549605396 0.5652803470167225 -3.4073210552970394 21.970240169847074 3.9970664090345425 0.9597573729664305 -1.5756072035483115 -0.20579244866111535 -0.39324575322868166 -0.5107962290560494 -0.8506253987005598 0.08352148942418823;
 -11.674328278829252 10.964846255253542 7.395491705487934 14.59283052764097 1.8905283340590437 -3.093117621972404 3.9970664090345425 21.947669179679824 1.1402759671571847 0.2319410920788116 0.6530054500747371 -0.8359150102071098 -0.9936792465774011 -0.21441746125366556 0.20305304032286847;
 -8.584910593648367 12.226923148551275 8.232326525855513 6.812540451286797 9.935797243414894 -0.65062472264608 0.9597573729664305 1.1402759671571847 18.519529716103374 1.7920204658737866 1.686540408907867 -0.1341374075621448 1.5877565574589376 -0.02918581910252978 -1.7184491528455619;
 -3.6149865536639396 9.693295430388714 18.3133965684684 5.179668251693076 7.493177619716803 1.878765218782392 -1.5756072035483115 0.2319410920788116 1.7920204658737866 13.01056098094525 -1.9369992691373805 -1.2016219312549279 1.964096182102801 0.6439954129375289 2.754021176860484;
 -23.821357080791458 9.994164280782872 22.299659090513515 19.708278563930865 5.719999867763334 1.1859659510153606 -0.20579244866111535 0.6530054500747371 1.686540408907867 -1.9369992691373805 23.711639533958294 -0.4452602681933064 -0.9917436477374509 0.7768269972691851 2.152844959760015;
 -7.850214422869778 1.4860751877588405 11.776459315169292 2.294139294813133 6.27995263027067 0.26300427106387203 -0.39324575322868166 -0.8359150102071098 -0.1341374075621448 -1.2016219312549279 -0.4452602681933064 19.148404361425307 -0.30824965887253675 0.8440151141347193 -4.4989691671782905;
 -5.834539862416373 11.480052609205849 9.103892786510723 20.030151533851793 9.101525048483031 1.9956174416566985 -0.5107962290560494 -0.9936792465774011 1.5877565574589376 1.964096182102801 -0.9917436477374509 -0.30824965887253675 14.567845226017363 -0.3635594623895073 2.8578099744483887;
 -11.084929510045262 3.7036112480402683 6.642551502337226 13.749375777499019 8.186414646512766 0.41418763132615416 -0.8506253987005598 -0.21441746125366556 -0.02918581910252978 0.6439954129375289 0.7768269972691851 0.8440151141347193 -0.3635594623895073 19.075658182825933 -4.292657678651246;
 5.492018685253233 7.863070744894561 5.123264411125625 4.022492474131356 20.107392850751552 1.5718501896477206 0.08352148942418823 0.20305304032286847 -1.7184491528455619 2.754021176860484 2.152844959760015 -4.4989691671782905 2.8578099744483887 -4.292657678651246 16.43765976119262;
]
solve(n, X, P8, Q8, M8, true)
## Multiplier-1
P9 = 16449*X[1]^2//1000 - 21483*X[1]*X[2]//2500 - 90229*X[1]*X[3]//10000 - 17203*X[1]*X[4]//5000 - 3194*X[1]//125 + 6521*X[2]^2//500 + 59953*X[2]*X[3]//10000 + 35111*X[2]*X[4]//100000 + 11761*X[2]//1000 + 12993*X[3]^2//1000 - 3843*X[3]*X[4]//40000 + 2429*X[3]//200 + 1269*X[4]^2//125 + 32969*X[4]//10000 + 3831//200
M9 = [1, X[4], X[3], X[2], X[1]]
Q9 = [19.15492941137621 1.6505950759951724 6.063375691865019 5.876840096044575 -12.767927651395478;
 1.6505950759951724 10.152195574178034 -0.050615918138216226 0.17386722122039827 -1.718449152845445;
 6.063375691865019 -0.050615918138216226 12.988587785593365 2.996860073894145 -4.498969167177443;
 5.876840096044575 0.17386722122039827 2.996860073894145 13.039929356466972 -4.292657678650797;
 -12.767927651395478 -1.718449152845445 -4.498969167177443 -4.292657678650797 16.437659761191952;
]
solve(n, X, P9, Q9, M9, true)
# Lie
## Multiplier-4
P10 = 14295719*X[1]^2//5000 + 3492969*X[1]*X[2]//2500 - 56181*X[1]*X[3]//400 + 2131009*X[1]*X[4]//1000 - 10415597*X[1]//1250 + 95748253*X[2]^2//10000 + 19370353*X[2]*X[3]//1000 + 37065687*X[2]*X[4]//5000 + 1998983*X[2]//100 + 14560751*X[3]^2//1000 + 1725893*X[3]*X[4]//125 + 19413591*X[3]//1000 + 45347751*X[4]^2//5000 - 14176033*X[4]//5000 + 11081113//500
M10 = [1, X[4], X[3], X[2], X[1]]
Q10 = [22162.2255405311 -1425.9919492372405 9714.037325954623 10004.491252126692 -4158.413053078709;
 -1425.9919492372405 9070.674459700946 6895.975839657844 3700.6439284229664 1063.9523875144043;
 9714.037325954623 6895.975839657844 14561.290273628803 9688.213240072988 -72.2743910946815;
 10004.491252126692 3700.6439284229664 9688.213240072988 9580.714104053744 698.7456394941994;
 -4158.413053078709 1063.9523875144043 -72.2743910946815 698.7456394941994 2856.126702535928;
]
solve(n, X, P10, Q10, M10, true)
## Multiplier-3
P11 = 9251079*X[1]^2//5000 - 20707619*X[1]*X[2]//50000 - 7866773*X[1]*X[3]//5000 + 19785289*X[1]*X[4]//10000 - 14500109*X[1]//2000 + 7318567*X[2]^2//500 + 27715399*X[2]*X[3]//1000 + 9348171*X[2]*X[4]//2000 + 4740499*X[2]//125 + 17314129*X[3]^2//1000 + 92369153*X[3]*X[4]//10000 + 35309957*X[3]//1000 + 59155513*X[4]^2//10000 - 34252871*X[4]//10000 + 4195567//125
M11 = [1, X[4], X[3], X[2], X[1]]
Q11 = [33564.53638805688 -1716.8513786283354 17654.752678900648 18959.0729624067 -3639.270234125298;
 -1716.8513786283354 5915.918982266167 4617.624691184714 2332.4885072573056 988.6294279146507;
 17654.752678900648 4617.624691184714 17316.58485379316 13853.007892459704 -795.1230023562943;
 18959.0729624067 2332.4885072573056 13853.007892459704 14630.752164183836 -216.01613113309904;
 -3639.270234125298 988.6294279146507 -795.1230023562943 -216.01613113309904 1853.2039341962802;
]
solve(n, X, P11, Q11, M11, true)
## Multiplier-2
P12 = 2955519*X[1]^2//1250 - 88636083*X[1]*X[2]//100000 - 45552683*X[1]*X[3]//10000 + 5458749*X[1]*X[4]//5000 - 95214469*X[1]//10000 + 3274271*X[2]^2//250 + 28975819*X[2]*X[3]//1000 + 49567997*X[2]*X[4]//10000 + 8678531*X[2]//250 + 21800031*X[3]^2//1000 + 2567413*X[3]*X[4]//250 + 43625539*X[3]//1000 + 56677321*X[4]^2//10000 - 10799217*X[4]//10000 + 33766101//1000
M12 = [1, X[4], X[3], X[2], X[1]]
Q12 = [33766.100737636145 -554.853323266475 21798.488858436187 17354.880151870715 -4776.393400076187;
 -554.853323266475 5668.219287814884 5124.392917299159 2471.0510292112135 549.0574215385506;
 21798.488858436187 5124.392917299159 21779.933965325916 14478.003104041682 -2284.3666209589583;
 17354.880151870715 2471.0510292112135 14478.003104041682 13095.544017635819 -451.459992236285;
 -4776.393400076187 549.0574215385506 -2284.3666209589583 -451.459992236285 2367.5735608874606;
]
solve(n, X, P12, Q12, M12, true)
## Total Decomposition
P13 = 33761769*X[1]^4//10000 + 11194659*X[1]^3*X[2]//5000 - 29622707*X[1]^3*X[3]//100000 + 4905147*X[1]^3*X[4]//2500 - 9457321*X[1]^3//2500 + 12601227*X[1]^2*X[2]^2//1000 + 4951067*X[1]^2*X[2]*X[3]//250 + 6753199*X[1]^2*X[2]*X[4]//1250 + 10929299*X[1]^2*X[2]//500 + 431309*X[1]^2*X[3]^2//25 + 11068351*X[1]^2*X[3]*X[4]//1000 + 12058269*X[1]^2*X[3]//500 + 2057629*X[1]^2*X[4]^2//200 - 18525721*X[1]^2*X[4]//5000 + 11816507*X[1]^2//1000 - 89873231*X[1]*X[2]^3//100000 - 22824069*X[1]*X[2]^2*X[3]//5000 + 5609819*X[1]*X[2]^2*X[4]//5000 - 33361429*X[1]*X[2]^2//10000 - 42275661*X[1]*X[2]*X[3]^2//100000 + 1518223*X[1]*X[2]*X[3]*X[4]//125000 + 3197714*X[1]*X[2]*X[3]//125 + 6978457*X[1]*X[2]*X[4]^2//5000 + 15586439*X[1]*X[2]*X[4]//1000 + 20731941*X[1]*X[2]//1000 - 15872547*X[1]*X[3]^3//10000 + 9899873*X[1]*X[3]^2*X[4]//5000 + 17200173*X[1]*X[3]^2//1000 - 7214641*X[1]*X[3]*X[4]^2//50000 + 13171179*X[1]*X[3]*X[4]//500 + 4100569*X[1]*X[3]//125 + 10632917*X[1]*X[4]^3//5000 + 12495897*X[1]*X[4]^2//10000 + 3859059*X[1]*X[4]//200 + 10238731*X[1]//1000 + 3273207*X[2]^4//250 + 28955409*X[2]^3*X[3]//1000 + 9849423*X[2]^3*X[4]//2000 + 14740601*X[2]^3//2500 + 910351*X[2]^2*X[3]^2//25 + 1024403*X[2]^2*X[3]*X[4]//100 - 8710831*X[2]^2*X[3]//250 + 15271069*X[2]^2*X[4]^2//1000 + 4938059*X[2]^2*X[4]//500 + 85148723*X[2]^2//10000 + 13849149*X[2]*X[3]^3//500 + 46803971*X[2]*X[3]^2*X[4]//10000 - 4646377*X[2]*X[3]^2//125 + 2426569*X[2]*X[3]*X[4]^2//125 + 45519961*X[2]*X[3]*X[4]//1000 - 67945367*X[2]*X[3]//10000 + 9247959*X[2]*X[4]^3//1250 + 12578553*X[2]*X[4]^2//250 + 8943697*X[2]*X[4]//200 + 5472509*X[2]//200 + 17317149*X[3]^4//1000 + 92402421*X[3]^3*X[4]//10000 + 79438877*X[3]^3//10000 + 20470989*X[3]^2*X[4]^2//1000 + 3981018*X[3]^2*X[4]//125 + 7993151*X[3]^2//250 + 13784083*X[3]*X[4]^3//1000 + 7629274*X[3]*X[4]^2//125 + 3585153*X[3]*X[4]//50 + 23521337*X[3]//500 + 90725817*X[4]^4//10000 + 5234086*X[4]^3//625 + 21242191*X[4]^2//500 + 26570599*X[4]//1000 + 11033371//250
M13 = [1, X[4], X[3], X[2], X[1], X[4]^2, X[3]*X[4], X[2]*X[4], X[1]*X[4], X[3]^2, X[2]*X[3], X[1]*X[3], X[2]^2, X[1]*X[2], X[1]^2]
Q13 = [44133.48442594882 13297.169089786898 23508.031204940056 13691.557038922074 5104.105458096728 5518.722268945088 15638.154737236384 10044.55375630477 3591.593231194907 -4124.759876087007 -13939.07482370981 9121.07038992177 -8860.194094856311 7690.965335423217 -2336.727950758075;
 13297.169089786898 31457.236503499546 20239.565638634922 12318.743556754493 6074.123040553606 4193.516920617408 21590.88277674496 17836.396806785724 -160.2197822887754 306.08458788859707 -890.8545712791607 5269.300358132185 -1919.254763310489 3540.636292509247 -993.0436169858073;
 23508.031204940056 20239.565638634922 40175.96590295235 10567.858896319854 7273.087445589877 8933.410108596909 15622.579799807076 11348.124534029886 4099.7790056916165 3966.337638195594 -10373.452316641818 7367.388924482009 -11345.464536199535 7984.93055053072 1139.8816921620437;
 13691.557038922074 12318.743556754493 10567.858896319854 26270.83191660832 2693.561871016898 7303.161130061191 12294.127490332909 6872.805704311416 1983.891299593904 -8220.113719463752 -6076.605259421755 4597.878872170394 2951.924045911957 304.2752808556064 1212.0823656219595;
 5104.105458096728 6074.123040553606 7273.087445589877 2693.561871016898 16493.517935168642 783.309993448092 3800.4224041063158 2260.746408749449 -839.5155797059911 1218.5310821996582 194.33431741293978 10926.077889522292 -1970.3729974801602 9726.24765215201 -1886.009335272389;
 5518.722268945088 4193.516920617408 8933.410108596909 7303.161130061191 783.309993448092 9070.674459701897 6895.97583965716 3700.6439284228036 1063.952387514807 -3009.7986052376236 -5963.599530593608 672.0070316377547 -1997.026821487129 327.5475794645778 944.9750376016528;
 15638.154737236384 21590.88277674496 15622.579799807076 12294.127490332909 3800.4224041063158 6895.97583965716 26496.80646636936 15651.812770666933 -744.2814227324376 4617.624691185461 1253.8484047681845 3126.3672692505233 -837.9296989132758 2577.4991387819946 -511.5977207542781;
 10044.55375630477 17836.396806785724 11348.124534029886 6872.805704311416 2260.746408749449 3700.6439284228036 15651.812770666933 19242.98703483818 371.19806003023245 1078.6401024886904 5962.3226162128185 1851.5805495150482 2471.051029211599 2505.4452167471864 -540.7748206835787;
 3591.593231194907 -160.2197822887754 4099.7790056916165 1983.891299593904 -839.5155797059911 1063.952387514807 -744.2814227324376 371.19806003023245 8409.592619908653 -2137.737841334969 -4429.079688296983 6061.48723974772 -1956.3877952089103 3260.9456976358983 980.0309221671303;
 -4124.759876087007 306.08458788859707 3966.337638195594 -8220.113719463752 1218.5310821996582 -3009.7986052376236 4617.624691185461 1078.6401024886904 -2137.737841334969 17316.584853793865 13853.007892457443 -795.1230023560304 1264.3938564363377 1940.7807385138065 -453.9730254099378;
 -13939.07482370981 -890.8545712791607 -10373.452316641818 -6076.605259421755 194.33431741293978 -5963.599530593608 1253.8484047681845 5962.3226162128185 -4429.079688296983 13853.007892457443 33881.89841664311 -2156.796869645017 14478.00310404049 72.7703182018899 -1551.9246606221357;
 9121.07038992177 5269.300358132185 7367.388924482009 4597.878872170394 10926.077889522292 672.0070316377547 3126.3672692505233 1851.5805495150482 6061.48723974772 -795.1230023560304 -2156.796869645017 18157.38787546724 -2357.13693916057 11453.858121294339 -143.58688565171613;
 -8860.194094856311 -1919.254763310489 -11345.464536199535 2951.924045911957 -1970.3729974801602 -1997.026821487129 -837.9296989132758 2471.051029211599 -1956.3877952089103 1264.3938564363377 14478.00310404049 -2357.13693916057 13095.54401763708 -451.459992237872 -385.63213956739287;
 7690.965335423217 3540.636292509247 7984.93055053072 304.2752808556064 9726.24765215201 327.5475794645778 2577.4991387819946 2505.4452167471864 3260.9456976358983 1940.7807385138065 72.7703182018899 11453.858121294339 -451.459992237872 13376.22405363372 1120.3471645808975;
 -2336.727950758075 -993.0436169858073 1139.8816921620437 1212.0823656219595 -1886.009335272389 944.9750376016528 -511.5977207542781 -540.7748206835787 980.0309221671303 -453.9730254099378 -1551.9246606221357 -143.58688565171613 -385.63213956739287 1120.3471645808975 3380.853441265682;
]
solve(n, X, P13, Q13, M13, true)
## Multiplier-1
P14 = 8456701*X[1]^2//2500 + 11157667*X[1]*X[2]//5000 - 14812899*X[1]*X[3]//50000 + 9821921*X[1]*X[4]//5000 - 12101069*X[1]//2500 + 1279788*X[2]^2//125 + 9899417*X[2]*X[3]//500 + 27125711*X[2]*X[4]//5000 + 23565067*X[2]//1000 + 7695277*X[3]^2//500 + 11091817*X[3]*X[4]//1000 + 13181463*X[3]//500 + 4653597*X[4]^2//625 - 47878857*X[4]//10000 + 26901481//1000
M14 = [1, X[4], X[3], X[2], X[1]]
Q14 = [26901.48120647907 -2380.7972423526116 13189.866549065287 11780.259096526768 -2410.158808710759;
 -2380.7972423526116 7443.415992578601 5549.889518992941 2720.170876952441 980.0309221662442;
 13189.866549065287 5549.889518992941 15396.237890453378 9901.933460672952 -143.58688565225228;
 11780.259096526768 2720.170876952441 9901.933460672952 10237.386213624215 1120.3471645854847;
 -2410.158808710759 980.0309221662442 -143.58688565225228 1120.3471645854847 3380.853441268934;
]
solve(n, X, P14, Q14, M14, true)
