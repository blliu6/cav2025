include("utils/util.jl")
include("utils/newtonUpdate.jl")
include("utils/rationalSOS.jl")

X = nothing
eig_tol = 1e-4
tol = 1e-50


function solve(n, X, f, Q, mono,newton)
    
    Q = round.(Q, digits=7)
    rQ = symplify_rational.(Q)

    model = nothing
    if !newton
        model = rational_SOS(f, 1, 0, mono, rQ)
    else
        update_Q = newton_refine_update(f, mono, Q, eig_tol, 550, tol, X)
        Q_res = symplify_rational.(update_Q*update_Q')
        model = rational_SOS(f, 1, 0, mono, Q_res)
    end
    
    SOSrational_time, coeffs, terms = model[2:end]
    
    @show expand(f-(coeffs' * terms.^2))

    data = Dict(
        "n" => n,
        "expression" => f,
        "coeff" => join([string(c) for c in coeffs], ","),
        "term" => join([string(t) for t in terms], ","),
        "SOSrational_time" => SOSrational_time,
        "SOS_expression" => string(coeffs' * terms.^2)
    )

    # save("src/output/data.json", data)    
end

n = 4
@Symbolics.variables X[1:n]



#C12
# init
## Multiplier-4
P0 = 3441*X[1]^2//1000 + 3211*X[1]*X[2]//5000 - 3367*X[1]*X[3]//100000 - 653*X[1]*X[4]//50000 - 133*X[1]//200 + 1231*X[2]^2//500 - 271*X[2]*X[3]//10000 - 877*X[2]*X[4]//50000 + 1887*X[2]//1000 + 1187*X[3]^2//1000 + 53*X[3]*X[4]//4000 - 1243*X[3]//100000 + 2201*X[4]^2//1000 - 2917*X[4]//100000 + 1039//500
M0 = [1, X[4], X[3], X[2], X[1]]
Q0 = [2.077990646824806 -0.014146181433545804 -0.005758653164814473 0.9440537122287644 -0.3320424681531658;
 -0.014146181433545804 2.2006707324655483 0.0056384527974785706 -0.008289179168926826 -0.006369231096570689;
 -0.005758653164814473 0.0056384527974785706 1.186925754428472 -0.013806161282592244 -0.016497154889121225;
 0.9440537122287644 -0.008289179168926826 -0.013806161282592244 2.462734566596255 0.3216673413991585;
 -0.3320424681531658 -0.006369231096570689 -0.016497154889121225 0.3216673413991585 3.44112644654151;
]
solve(n, X, P0, Q0, M0, true)
## Multiplier-3
P1 = 418*X[1]^2//125 + 6037*X[1]*X[2]//10000 - 391*X[1]*X[3]//10000 - 2879*X[1]*X[4]//100000 - 3507*X[1]//5000 + 121*X[2]^2//50 - 1233*X[2]*X[3]//50000 - 3497*X[2]*X[4]//100000 + 1587*X[2]//500 + 937*X[3]^2//1000 + 2213*X[3]*X[4]//100000 - 3099*X[3]//1000000 + 119*X[4]^2//1000 + 2373*X[4]//250000 + 351//250
M1 = [1, X[4], X[3], X[2], X[1]]
Q1 = [1.4036962914125553 0.005097795731533164 -0.0011182298495053917 1.5865656880629682 -0.3508813194960887;
 0.005097795731533164 0.1191078956267543 0.011116489806041272 -0.017127919814279406 -0.014527413734487862;
 -0.0011182298495053917 0.011116489806041272 0.9367755775887929 -0.01171435847311418 -0.01958935375509922;
 1.5865656880629682 -0.017127919814279406 -0.01171435847311418 2.4200933961839137 0.30157435758562934;
 -0.3508813194960887 -0.014527413734487862 -0.01958935375509922 0.30157435758562934 3.3442481213624293;
]
solve(n, X, P1, Q1, M1, true)
## Multiplier-2
P2 = 31929*X[1]^2//5000 - 20527*X[1]*X[2]//10000 + 94387*X[1]*X[3]//1000000 + 38239*X[1]*X[4]//500000 + 16719*X[1]//5000 + 94349*X[2]^2//10000 - 36487*X[2]*X[3]//100000 + 25447*X[2]*X[4]//100000 - 301*X[2]//20 + 54187*X[3]^2//10000 - 19707*X[3]*X[4]//100000 + 88849*X[3]//100000 + 13911*X[4]^2//1000 - 19811*X[4]//100000 + 49179//1000
M2 = [1, X[4], X[3], X[2], X[1]]
Q2 = [49.17889883332476 -0.0931718337107757 0.46702954460754315 -7.519876008227718 1.6556321979420507;
 -0.0931718337107757 13.910917817342062 -0.09570916815960268 0.12619310035559556 0.03795835933691381;
 0.46702954460754315 -0.09570916815960268 5.41913474865591 -0.18602098194093566 0.05013558665153544;
 -7.519876008227718 0.12619310035559556 -0.18602098194093566 9.433604213101608 -1.0246074572868837;
 1.6556321979420507 0.03795835933691381 0.05013558665153544 -1.0246074572868837 6.38511636788957;
]
solve(n, X, P2, Q2, M2, true)
## Total Decomposition
P3 = 1026*X[1]^4//125 - 37327*X[1]^3*X[2]//100000 + 20723*X[1]^3*X[3]//1000000 + 18423*X[1]^3*X[4]//500000 + 30723*X[1]^3//50000 + 6381*X[1]^2*X[2]^2//500 - 92619*X[1]^2*X[2]*X[3]//1000000 - 9351*X[1]^2*X[2]*X[4]//50000 + 93571*X[1]^2*X[2]//10000 + 21943*X[1]^2*X[3]^2//2500 + 6281*X[1]^2*X[3]*X[4]//250000 + 13959*X[1]^2*X[3]//100000 + 18719*X[1]^2*X[4]^2//2000 + 32679*X[1]^2*X[4]//100000 + 5481*X[1]^2//25000 - 511*X[1]*X[2]^3//250 + 24611*X[1]*X[2]^2*X[3]//250000 + 85713*X[1]*X[2]^2*X[4]//1000000 - 39513*X[1]*X[2]^2//50000 + 59579*X[1]*X[2]*X[3]^2//100000 - 3107*X[1]*X[2]*X[3]*X[4]//2500000 + 5019*X[1]*X[2]*X[3]//25000 + 1269*X[1]*X[2]*X[4]^2//2000 + 4027*X[1]*X[2]*X[4]//25000 + 2687*X[1]*X[2]//500 - 39201*X[1]*X[3]^3//1000000 - 31279*X[1]*X[3]^2*X[4]//1000000 - 70773*X[1]*X[3]^2//100000 - 16143*X[1]*X[3]*X[4]^2//500000 - 27433*X[1]*X[3]*X[4]//10000000 - 2723*X[1]*X[3]//20000 - 14723*X[1]*X[4]^3//1000000 - 6661*X[1]*X[4]^2//10000 - 23243*X[1]*X[4]//100000 - 1979*X[1]//1000 + 94313*X[2]^4//10000 - 36591*X[2]^3*X[3]//100000 + 189*X[2]^3*X[4]//800 + 383*X[2]^3//100 + 19601*X[2]^2*X[3]^2//2500 - 18203*X[2]^2*X[3]*X[4]//100000 + 5013*X[2]^2*X[3]//25000 + 16367*X[2]^2*X[4]^2//1000 + 968*X[2]^2*X[4]//3125 + 43007*X[2]^2//10000 - 17299*X[2]*X[3]^3//1000000 - 41609*X[2]*X[3]^2*X[4]//1000000 + 14001*X[2]*X[3]^2//1000 - 11257*X[2]*X[3]*X[4]^2//500000 - 7971*X[2]*X[3]*X[4]//20000 + 5469*X[2]*X[3]//25000 - 20789*X[2]*X[4]^3//1000000 + 29697*X[2]*X[4]^2//1000 - 4339*X[2]*X[4]//10000 - 893*X[2]//250 + 93569*X[3]^4//100000 + 5383*X[3]^3*X[4]//250000 + 23609*X[3]^3//10000000 + 13059*X[3]^2*X[4]^2//10000 + 30129*X[3]^2*X[4]//5000000 + 4293*X[3]^2//1250 + 76853*X[3]*X[4]^3//10000000 - 5383*X[3]*X[4]^2//500000 - 647*X[3]*X[4]//4000 - 3241*X[3]//100000 + 21999*X[4]^4//10000 - 15007*X[4]^3//500000 + 5199*X[4]^2//2000 - 2413*X[4]//10000 + 1609//200
M3 = [1, X[4], X[3], X[2], X[1], X[4]^2, X[3]*X[4], X[2]*X[4], X[1]*X[4], X[3]^2, X[2]*X[3], X[1]*X[3], X[2]^2, X[1]*X[2], X[1]^2]
Q3 = [8.045261501434373 -0.12131201380052305 -0.01643022361220142 -1.782295765278102 -0.9880786945680281 -2.8590598866809938 -3.265166840576223e-05 -0.2121536359123378 -0.09778808787124425 -0.5290105275718716 0.007913610858426467 -0.06393477958926858 -3.1153641754895727 1.425750381625054 -2.544065825922551;
 -0.12131201380052305 8.322384595443904 -0.07755741382819212 -0.008853064399325745 -0.021730244419450657 -0.014146181433377232 -0.0594084010689648 11.567682429583938 -0.7928253499115685 0.0008896939432770216 -0.08243370052878081 0.0002365013933210596 0.12147657957876237 0.010569383042161687 0.026091398325375027;
 -0.01643022361220142 -0.07755741382819212 4.499550514128489 0.10291605505249815 -0.0018089472765408184 0.05364974790413145 0.0042081017880067385 -0.113522250582513 0.0026731467723503373 -0.0011182298494916238 5.729339867307624 -0.5818267150486113 -0.06584360467933231 0.0315443873197543 0.02193487227394221;
 -1.782295765278102 -0.008853064399325745 0.10291605505249815 10.525827802736034 1.260927655856653 3.2872895145728998 0.004537609087453967 0.03773779494315194 0.0266875950987622 1.2763607309151688 0.16083117431731095 0.03081126136170562 1.9137284860195656 -0.26192388251509624 2.5794548765566008;
 -0.9880786945680281 -0.021730244419450657 -0.0018089472765408184 1.260927655856653 5.302567483373622 0.460782881758382 -0.0029096481656671843 0.03865974279542683 0.13603863856033513 0.23094539555265087 0.03791552760996742 0.047469525201482995 -0.13165889518901702 2.097563816713988 0.30635292281709586;
 -2.8590598866809938 -0.014146181433377232 0.05364974790413145 3.2872895145728998 0.460782881758382 2.200670732470977 0.005638452797422026 -0.008289179168724197 -0.006369231096525281 0.5139890521879589 0.08509976600798837 0.018639633370771208 -0.1510204963023851 -0.06040523167955409 1.28599284264486;
 -3.265166840576223e-05 -0.0594084010689648 0.0042081017880067385 0.004537609087453967 -0.0029096481656671843 0.005638452797422026 0.27805554567105173 -0.09890592729057594 -0.035136788259888814 0.011116489806140524 -0.024055023007600415 -0.016703813668648915 0.010032546750443655 0.001073880938178349 0.008597864281501888;
 -0.2121536359123378 11.567682429583938 -0.113522250582513 0.03773779494315194 0.03865974279542683 -0.008289179168724197 -0.09890592729057594 16.675693376547578 0.38207257307876225 0.00692710319318378 -0.10574171490999452 -0.006330879888711482 0.12619310035526252 -0.03184009232628068 0.0397792096885793;
 -0.09778808787124425 -0.7928253499115685 0.0026731467723503373 0.0266875950987622 0.13603863856033513 -0.006369231096525281 -0.035136788259888814 0.38207257307876225 6.790356250957128 0.002176399934080119 0.005256998950530439 0.004379429144965337 0.06979845166319448 -0.13536416091006515 0.020360272184988332;
 -0.5290105275718716 0.0008896939432770216 -0.0011182298494916238 1.2763607309151688 0.23094539555265087 0.5139890521879589 0.011116489806140524 0.00692710319318378 0.002176399934080119 0.9367755775883317 -0.011714358473123073 -0.019589353755094508 -0.15200425833201467 -0.010005473101379676 0.7110138928283255;
 0.007913610858426467 -0.08243370052878081 5.729339867307624 0.16083117431731095 0.03791552760996742 0.08509976600798837 -0.024055023007600415 -0.10574171490999452 0.005256998950530439 -0.011714358473123073 8.143236661503218 0.31157983068716555 -0.18602098194095845 0.026027590305269254 0.009396149455942127;
 -0.06393477958926858 0.0002365013933210596 -0.5818267150486113 0.03081126136170562 0.047469525201482995 0.018639633370771208 -0.016703813668648915 -0.006330879888711482 0.004379429144965337 -0.019589353755094508 0.31157983068716555 7.354922998726151 0.024107996346268243 -0.053175672856840606 0.008319596822023288;
 -3.1153641754895727 0.12147657957876237 -0.06584360467933231 1.9137284860195656 -0.13165889518901702 -0.1510204963023851 0.010032546750443655 0.12619310035526252 0.06979845166319448 -0.15200425833201467 -0.18602098194095845 0.024107996346268243 9.433604213104317 -1.0246074572872272 1.9169149355999104;
 1.425750381625054 0.010569383042161687 0.0315443873197543 -0.26192388251509624 2.097563816713988 -0.06040523167955409 0.001073880938178349 -0.03184009232628068 -0.13536416091006515 -0.010005473101379676 0.026027590305269254 -0.053175672856840606 -1.0246074572872272 8.929610033015368 -0.18800951809138516;
 -2.544065825922551 0.026091398325375027 0.02193487227394221 2.5794548765566008 0.30635292281709586 1.28599284264486 0.008597864281501888 0.0397792096885793 0.020360272184988332 0.7110138928283255 0.009396149455942127 0.008319596822023288 1.9169149355999104 -0.18800951809138516 8.209403974035006;
]
solve(n, X, P3, Q3, M3, true)
## Multiplier-1
P4 = 41049*X[1]^2//5000 - 9433*X[1]*X[2]//25000 + 7339*X[1]*X[3]//500000 + 44593*X[1]*X[4]//1000000 + 383*X[1]//625 + 31891*X[2]^2//5000 - 85681*X[2]*X[3]//1000000 - 4829*X[2]*X[4]//25000 - 273*X[2]//80 + 13581*X[3]^2//2500 + 25807*X[3]*X[4]//1000000 + 3271*X[3]//25000 + 11843*X[4]^2//2000 + 3281*X[4]//10000 + 10937//1000
M4 = [1, X[4], X[3], X[2], X[1]]
Q4 = [10.936990719948831 0.1621300368857147 0.0694043974754406 -1.7080978649104315 0.30635292281718296;
 0.1621300368857147 5.921215489705959 0.012977293426477556 -0.09558495122143444 0.02036027218497862;
 0.0694043974754406 0.012977293426477556 5.432702663020334 -0.043779523400888976 0.008319596822018766;
 -1.7080978649104315 -0.09558495122143444 -0.043779523400888976 6.378323536327377 -0.1880095180913421;
 0.30635292281718296 0.02036027218497862 0.008319596822018766 -0.1880095180913421 8.209403974034437;
]
solve(n, X, P4, Q4, M4, true)
# unsafe
## Multiplier-4
P5 = 2343*X[1]^2//1000 + 3199*X[1]*X[2]//1000 + 2791*X[1]*X[3]//100000 + 6217*X[1]*X[4]//100000 + 5867*X[1]//1000 + 1053*X[2]^2//100 + 57*X[2]*X[3]//400 - 2367*X[2]*X[4]//25000 + 9927*X[2]//1000 + 573*X[3]^2//5000 - 2187*X[3]*X[4]//100000 + 9937*X[3]//100000 + 357*X[4]^2//200 - 4969*X[4]//100000 + 951//200
M5 = [1, X[4], X[3], X[2], X[1]]
Q5 = [4.752232811279263 -0.022796466216535426 0.04888592474536978 4.961964810418036 2.9302422225226388;
 -0.022796466216535426 1.7850414901588028 -0.010466359641799592 -0.04602229344007554 0.03197454952623552;
 0.04888592474536978 -0.010466359641799592 0.11477433552411768 0.07050943929679347 0.013408548398568901;
 4.961964810418036 -0.04602229344007554 0.07050943929679347 10.528371271778319 1.5985093685246858;
 2.9302422225226388 0.03197454952623552 0.013408548398568901 1.5985093685246858 2.339761593394593;
]
solve(n, X, P5, Q5, M5, true)
## Multiplier-3
P6 = 1271*X[1]^2//500 + 259*X[1]*X[2]//100 + 12*X[1]*X[3]//625 + 1119*X[1]*X[4]//25000 + 5899*X[1]//1000 + 9553*X[2]^2//1000 + 523*X[2]*X[3]//5000 - 173*X[2]*X[4]//3125 + 9943*X[2]//1000 + 9133*X[3]^2//10000 - 1441*X[3]*X[4]//100000 + 1471*X[3]//20000 + 709*X[4]^2//500 - 1567*X[4]//50000 + 5239//1000
M6 = [1, X[4], X[3], X[2], X[1]]
Q6 = [5.23938743112775 -0.015895374637450832 0.034154745105735775 4.973504981458636 2.9474566938540305;
 -0.015895374637450832 1.418308442888393 -0.007186511063908516 -0.027323320461674745 0.022753839458134584;
 0.034154745105735775 -0.007186511063908516 0.9128790751270282 0.050220122740256154 0.007911354012393079;
 4.973504981458636 -0.027323320461674745 0.050220122740256154 9.556114149060642 1.2948824015742102;
 2.9474566938540305 0.022753839458134584 0.007911354012393079 1.2948824015742102 2.5387347688791126;
]
solve(n, X, P6, Q6, M6, true)
## Multiplier-2
P7 = 20559*X[1]^2//1000 + 64713*X[1]*X[2]//10000 - 5011*X[1]*X[3]//25000 - 10669*X[1]*X[4]//20000 - 4152*X[1]//125 + 11071*X[2]^2//1000 - 10919*X[2]*X[3]//100000 - 7559*X[2]*X[4]//50000 - 97969*X[2]//10000 + 16543*X[3]^2//1000 + 93701*X[3]*X[4]//1000000 + 34989*X[3]//500000 + 77829*X[4]^2//10000 + 3923*X[4]//6250 + 34743//1000
M7 = [1, X[4], X[3], X[2], X[1]]
Q7 = [34.74275955498053 0.3070014682407264 0.02355680290668187 -4.883411993697745 -16.59369117451175;
 0.3070014682407264 7.782445948885107 0.04650552613354065 -0.07167803498939265 -0.2645919702196224;
 0.02355680290668187 0.04650552613354065 16.543022292420734 -0.05322075284357309 -0.09198645078361073;
 -4.883411993697745 -0.07167803498939265 -0.05322075284357309 11.066770253406839 3.2237258338113315;
 -16.59369117451175 -0.2645919702196224 -0.09198645078361073 3.2237258338113315 20.545130393401983;
]
solve(n, X, P7, Q7, M7, true)
## Total Decomposition
P8 = 30299*X[1]^4//5000 + 10889*X[1]^3*X[2]//10000 - 22801*X[1]^3*X[3]//100000 + 323*X[1]^3*X[4]//10000 + 1441*X[1]^3//125 + 14823*X[1]^2*X[2]^2//500 - 511*X[1]^2*X[2]*X[3]//4000 - 1371*X[1]^2*X[2]*X[4]//125000 - 7047*X[1]^2*X[2]//2500 + 32653*X[1]^2*X[3]^2//5000 - 11927*X[1]^2*X[3]*X[4]//1000000 - 5179*X[1]^2*X[3]//20000 + 14893*X[1]^2*X[4]^2//2000 + 4277*X[1]^2*X[4]//2000000 + 689*X[1]^2//250 + 64511*X[1]*X[2]^3//10000 - 4811*X[1]*X[2]^2*X[3]//25000 - 26601*X[1]*X[2]^2*X[4]//50000 - 1497*X[1]*X[2]^2//100 + 12997*X[1]*X[2]*X[3]^2//5000 - 7947*X[1]*X[2]*X[3]*X[4]//500000 - 2421*X[1]*X[2]*X[3]//12500 + 32187*X[1]*X[2]*X[4]^2//10000 - 393*X[1]*X[2]*X[4]//20000 - 25737*X[1]*X[2]//1000 + 12819*X[1]*X[3]^3//1000000 + 48533*X[1]*X[3]^2*X[4]//1000000 + 13869*X[1]*X[3]^2//1000 + 4177*X[1]*X[3]*X[4]^2//200000 - 3459*X[1]*X[3]*X[4]//125000 + 48817*X[1]*X[3]//100000 + 28391*X[1]*X[4]^3//500000 + 16067*X[1]*X[4]^2//1000 + 86109*X[1]*X[4]//1000000 - 3839*X[1]//25000 + 11069*X[2]^4//1000 - 24733*X[2]^3*X[3]//250000 - 13443*X[2]^3*X[4]//100000 - 6109*X[2]^3//625 + 26101*X[2]^2*X[3]^2//1000 + 10981*X[2]^2*X[3]*X[4]//125000 + 11179*X[2]^2*X[3]//200000 + 18317*X[2]^2*X[4]^2//1000 + 12533*X[2]^2*X[4]//20000 + 10443*X[2]^2//1000 + 48873*X[2]*X[3]^3//500000 - 19371*X[2]*X[3]^2*X[4]//500000 + 99391*X[2]*X[3]^2//10000 + 69*X[2]*X[3]*X[4]^2//500 - 21781*X[2]*X[3]*X[4]//2500000 + 19547*X[2]*X[3]//25000 - 48777*X[2]*X[4]^3//500000 + 24803*X[2]*X[4]^2//2500 + 77227*X[2]*X[4]//100000 + 13547*X[2]//500 + 91431*X[3]^4//100000 - 3747*X[3]^3*X[4]//250000 + 13337*X[3]^3//200000 + 1921*X[3]^2*X[4]^2//1250 - 5063*X[3]^2*X[4]//200000 + 4251*X[3]^2//1000 - 10391*X[3]*X[4]^3//500000 + 91737*X[3]*X[4]^2//1000000 - 44113*X[3]*X[4]//1000000 + 38343*X[3]//50000 + 3571*X[4]^4//2000 - 27283*X[4]^3//500000 + 18979*X[4]^2//2000 + 1147*X[4]//6250 + 15341//1000
M8 = [1, X[4], X[3], X[2], X[1], X[4]^2, X[3]*X[4], X[2]*X[4], X[1]*X[4], X[3]^2, X[2]*X[3], X[1]*X[3], X[2]^2, X[1]*X[2], X[1]^2]
Q8 = [15.341026873658885 0.09233205048837632 0.3846193161289817 13.553548481204603 -0.07549524319385893 0.09596959673705849 -0.015146058187277168 0.22781472263708266 0.06385363980697567 -1.8076182458399699 0.08438325368600086 0.2236175964675903 -5.0890866682627385 -10.403044086364856 -3.6013497448072593;
 0.09233205048837632 9.306429072808807 -0.007008178374702759 0.15267853765852857 -0.01510722322808886 -0.02279646621638333 0.03074804738850116 5.526811407646062 7.367699810746144 -0.02358027437596022 0.0038569185649097843 -0.009122112259504461 -0.020644787545080177 -0.08685684784477817 0.019632817111377168;
 0.3846193161289817 -0.007008178374702759 7.871623798014346 0.30383864590493637 0.017487881974616794 0.018137877357653997 0.00768489973854766 0.009542837937385532 -0.0052923894152350675 0.03415474510511816 6.726092186168657 5.679980938049999 -0.07993639619993119 -0.1963579163115526 -0.15726545843804232;
 13.553548481204603 0.15267853765852857 0.30383864590493637 20.639837889795142 -2.4713661633032706 -0.5648465972287573 -0.013399756502293457 0.3276462557859893 0.07847268256940336 -1.7525872047094129 0.10349319910657853 0.13140670402312468 -4.883411993697477 -9.992135598205945 -3.4761215239099394;
 -0.07549524319385893 -0.01510722322808886 0.017487881974616794 -2.4713661633032706 9.969024172451817 0.6595355481321803 -0.0012199166497192675 -0.00041119626110379447 -0.011785205665134336 1.248767943578073 -0.031063504414711555 0.033011088477987845 2.494911793819365 2.0679197220048198 5.760016958760422;
 0.09596959673705849 -0.02279646621638333 0.018137877357653997 -0.5648465972287573 0.6595355481321803 1.7850414901584042 -0.010466359641784105 -0.04602229344006899 0.031974549526290245 0.26354942324476144 0.018320985306137624 0.015208232994851495 1.005845827548053 0.5602089095786577 0.060165606187297264;
 -0.015146058187277168 0.03074804738850116 0.00768489973854766 -0.013399756502293457 -0.0012199166497192675 -0.010466359641784105 1.005983931928359 0.05218845399063271 -0.001799684595512069 -0.007186511063922292 0.00040149000865431403 0.03242487886378395 -0.003561377179823575 0.004655606243068308 0.0024897767854679177;
 0.22781472263708266 5.526811407646062 0.009542837937385532 0.3276462557859893 -0.00041119626110379447 -0.04602229344006899 0.05218845399063271 16.299125565567195 1.0383004589458527 -0.027724810470341994 0.050066903313348815 -0.0038117734680837476 -0.07167803498938338 -0.2858398108277669 -0.008915777638292889;
 0.06385363980697567 7.367699810746144 -0.0052923894152350675 0.07847268256940336 -0.011785205665134336 0.031974549526290245 -0.001799684595512069 1.0383004589458527 7.316423365478366 -0.00967103940566387 -0.0008438327749839766 -0.010306985714744152 0.021247840608148525 0.004518097001155656 0.01860362053774843;
 -1.8076182458399699 -0.02358027437596022 0.03415474510511816 -1.7525872047094129 1.248767943578073 0.26354942324476144 -0.007186511063922292 -0.027724810470341994 -0.00967103940566387 0.9128790751309769 0.050220122740213424 0.007911354011344206 1.0647122416810044 1.0705003178228645 0.5413167572650379;
 0.08438325368600086 0.0038569185649097843 6.726092186168657 0.10349319910657853 -0.031063504414711555 0.018320985306137624 0.00040149000865431403 0.050066903313348815 -0.0008438327749839766 0.050220122740213424 23.969711958128567 0.2243820837520536 -0.05322075284354269 -0.06725242641057608 -0.014863861225028882;
 0.2236175964675903 -0.009122112259504461 5.679980938049999 0.13140670402312468 0.033011088477987845 0.015208232994851495 0.03242487886378395 -0.0038117734680837476 -0.010306985714744152 0.007911354011344206 0.2243820837520536 5.43739332347118 -0.02473402437301129 -0.033143495696059434 -0.11156867568120729;
 -5.0890866682627385 -0.020644787545080177 -0.07993639619993119 -4.883411993697477 2.494911793819365 1.005845827548053 -0.003561377179823575 -0.07167803498938338 0.021247840608148525 1.0647122416810044 -0.05322075284354269 -0.02473402437301129 11.066770253407844 3.22372583381234 2.4606785021981996;
 -10.403044086364856 -0.08685684784477817 -0.1963579163115526 -9.992135598205945 2.0679197220048198 0.5602089095786577 0.004655606243068308 -0.2858398108277669 0.004518097001155656 1.0705003178228645 -0.06725242641057608 -0.033143495696059434 3.22372583381234 24.720240488035323 0.5477354416752971;
 -3.6013497448072593 0.019632817111377168 -0.15726545843804232 -3.4761215239099394 5.760016958760422 0.060165606187297264 0.0024897767854679177 -0.008915777638292889 0.01860362053774843 0.5413167572650379 -0.014863861225028882 -0.11156867568120729 2.4606785021981996 0.5477354416752971 6.051092237331952;
]
solve(n, X, P8, Q8, M8, true)
## Multiplier-1
P9 = 6051*X[1]^2//1000 + 273*X[1]*X[2]//250 - 443*X[1]*X[3]//2000 + 129*X[1]*X[4]//4000 - 589*X[1]//1000 + 9097*X[2]^2//1000 - 949*X[2]*X[3]//10000 - 1551*X[2]*X[4]//100000 - 5007*X[2]//1000 + 3981*X[3]^2//1000 - 271*X[3]*X[4]//25000 + 953*X[3]//5000 + 5097*X[4]^2//1000 - 2591*X[4]//50000 + 8663//1000
M9 = [1, X[4], X[3], X[2], X[1]]
Q9 = [8.66320175317891 -0.029359630737971695 0.09888298804670967 -2.503672717916856 -0.2910754588769671;
 -0.029359630737971695 5.096992984455219 -0.007817208929253184 -0.00439768063715474 0.01860362053775833;
 0.09888298804670967 -0.007817208929253184 3.9812920691294758 -0.048007356920959546 -0.1115686756803148;
 -2.503672717916856 -0.00439768063715474 -0.048007356920959546 9.096467099033529 0.5477354416765067;
 -0.2910754588769671 0.01860362053775833 -0.1115686756803148 0.5477354416765067 6.051092237327111;
]
solve(n, X, P9, Q9, M9, true)
# Lie
## Multiplier-4
P10 = 19367*X[1]^2//10000 + 11291*X[1]*X[2]//5000 - 12303*X[1]*X[3]//100000 - 5229*X[1]*X[4]//500000 - 64191*X[1]//10000 + 2241*X[2]^2//1000 - 24797*X[2]*X[3]//1000000 - 32779*X[2]*X[4]//1000000 - 5523*X[2]//2000 + 5421*X[3]^2//2500 - 16047*X[3]*X[4]//1000000 + 54309*X[3]//100000 + 22363*X[4]^2//10000 + 66121*X[4]//100000 + 11801//1000
M10 = [1, X[4], X[3], X[2], X[1]]
Q10 = [11.800520790281645 0.33179593290390264 0.2668971243929085 -1.3757891163735028 -3.211476646030221;
 0.33179593290390264 2.2362107035777723 -0.007754666293580454 -0.0168643843048015 -0.006638392777158028;
 0.2668971243929085 -0.007754666293580454 2.1683243710015003 -0.012214633857907945 -0.05970967627584248;
 -1.3757891163735028 -0.0168643843048015 -0.012214633857907945 2.2399594228060793 1.1288427097388105;
 -3.211476646030221 -0.006638392777158028 -0.05970967627584248 1.1288427097388105 1.9384046675056996;
]
solve(n, X, P10, Q10, M10, true)
## Multiplier-3
P11 = 2351*X[1]^2//2500 + 6941*X[1]*X[2]//10000 + 371*X[1]*X[3]//12500 + 2189*X[1]*X[4]//100000 - 749*X[1]//500 + 1693*X[2]^2//1000 - 749*X[2]*X[3]//5000 + 591*X[2]*X[4]//25000 + 241*X[2]//100 + 2537*X[3]^2//1000 - 1037*X[3]*X[4]//50000 - 2699*X[3]//10000 + 1093*X[4]^2//10000 - 5061*X[4]//100000 + 211//100
M11 = [1, X[4], X[3], X[2], X[1]]
Q11 = [2.110132175490957 -0.025498562527588975 -0.13519431738482907 1.2040728879071185 -0.7492876236672353;
 -0.025498562527588975 0.10965387928368737 -0.010422287711866644 0.011757626734160094 0.011043614285449433;
 -0.13519431738482907 -0.010422287711866644 2.5371356803297984 -0.07461623671782204 0.014427707737484675;
 1.2040728879071185 0.011757626734160094 -0.07461623671782204 1.6920514617692968 0.3464935134730624;
 -0.7492876236672353 0.011043614285449433 0.014427707737484675 0.3464935134730624 0.9400319423999185;
]
solve(n, X, P11, Q11, M11, true)
## Multiplier-2
P12 = 2421*X[1]^2//2500 + 681*X[1]*X[2]//500 - 4169*X[1]*X[3]//100000 + 347*X[1]*X[4]//12500 - 1913*X[1]//2000 + 1067*X[2]^2//500 + 1689*X[2]*X[3]//20000 + 2591*X[2]*X[4]//50000 + 93*X[2]//40 + 1613*X[3]^2//1000 - 1427*X[3]*X[4]//100000 + 9209*X[3]//100000 + 679*X[4]^2//5000 - 2*X[4]//25 + 2001//1000
M12 = [1, X[4], X[3], X[2], X[1]]
Q12 = [2.0008909044633656 -0.04089818138230938 0.04521493423155758 1.1621018995491657 -0.47754465633371374;
 -0.04089818138230938 0.13608049539423916 -0.007110649062046447 0.025442335324463917 0.014095833453174634;
 0.04521493423155758 -0.007110649062046447 1.6136271330391683 0.04131337287011986 -0.020433112001962062;
 1.1621018995491657 0.025442335324463917 0.04131337287011986 2.1326635033436276 0.6818007538254682;
 -0.47754465633371374 0.014095833453174634 -0.020433112001962062 0.6818007538254682 0.9682520600986272;
]
solve(n, X, P12, Q12, M12, true)
## Total Decomposition
P13 = 1873*X[1]^4//1000 + 6199*X[1]^3*X[2]//5000000 - 16341*X[1]^3*X[3]//250000 - 7279*X[1]^3*X[4]//250000 - 36297*X[1]^3//100000 + 60819*X[1]^2*X[2]^2//10000 + 11341*X[1]^2*X[2]*X[3]//100000 - 4621*X[1]^2*X[2]*X[4]//62500 + 36103*X[1]^2*X[2]//5000 + 7217*X[1]^2*X[3]^2//2500 - 4051*X[1]^2*X[3]*X[4]//125000 + 39127*X[1]^2*X[3]//100000 + 4293*X[1]^2*X[4]^2//1250 + 19671*X[1]^2*X[4]//100000 - 57289*X[1]^2//10000 - 20151*X[1]*X[2]^3//5000 - 36777*X[1]*X[2]^2*X[3]//50000 - 12637*X[1]*X[2]^2*X[4]//100000 - 65569*X[1]*X[2]^2//10000 + 5729*X[1]*X[2]*X[3]^2//5000 + 18423*X[1]*X[2]*X[3]*X[4]//1000000 + 1821*X[1]*X[2]*X[3]//10000 - 88581*X[1]*X[2]*X[4]^2//100000 + 2941*X[1]*X[2]*X[4]//200000 + 11871*X[1]*X[2]//1000 + 85851*X[1]*X[3]^3//1000000 + 60533*X[1]*X[3]^2*X[4]//1000000 + 13851*X[1]*X[3]^2//10000 - 4599*X[1]*X[3]*X[4]^2//20000 - 4099*X[1]*X[3]*X[4]//25000 + 33553*X[1]*X[3]//100000 - 2001*X[1]*X[4]^3//62500 - 1397*X[1]*X[4]^2//10000 - 54821*X[1]*X[4]//1000000 + 1909*X[1]//1000 + 2237*X[2]^4//625 + 2857*X[2]^3*X[3]//40000 - 25009*X[2]^3*X[4]//500000 + 693*X[2]^3//200 + 4909*X[2]^2*X[3]^2//1250 - 63997*X[2]^2*X[3]*X[4]//1000000 - 149*X[2]^2*X[3]//1600 + 20057*X[2]^2*X[4]^2//5000 - 1603*X[2]^2*X[4]//50000 - 1753*X[2]^2//500 - 3691*X[2]*X[3]^3//125000 + 36567*X[2]*X[3]^2*X[4]//500000 + 60353*X[2]*X[3]^2//100000 - 35173*X[2]*X[3]*X[4]^2//1000000 - 62909*X[2]*X[3]*X[4]//1000000 - 19237*X[2]*X[3]//50000 - 9271*X[2]*X[4]^3//100000 + 8751*X[2]*X[4]^2//1000 + 987*X[2]*X[4]//3125 - 3223*X[2]//250 + 12067*X[3]^4//5000 - 12773*X[3]^3*X[4]//500000 + 56217*X[3]^3//100000 + 5327*X[3]^2*X[4]^2//2000 + 36871*X[3]^2*X[4]//50000 + 10897*X[3]^2//5000 - 30597*X[3]*X[4]^3//1000000 - 14503*X[3]*X[4]^2//100000 + 14459*X[3]*X[4]//100000 + 10511*X[3]//25000 + 13497*X[4]^4//5000 - 4719*X[4]^3//100000 - 11497*X[4]^2//1000 + 2909//125
M13 = [1, X[4], X[3], X[2], X[1], X[4]^2, X[3]*X[4], X[2]*X[4], X[1]*X[4], X[3]^2, X[2]*X[3], X[1]*X[3], X[2]^2, X[1]*X[2], X[1]^2]
Q13 = [23.272256695751974 -0.002288259165977228 0.2165118919946159 -6.443406042499766 0.9517297841222804 -6.663120587793526 0.046501715203226796 0.16331808768729986 0.017292866395106996 -0.1762731801635472 -0.13003138203944958 0.1301892073119003 -4.428318296659477 5.9196328756118985 -4.068097853224866;
 -0.002288259165977228 1.8145144242244367 0.025048122254883502 -0.004170222999371691 -0.0508789915148001 -0.02312576814180631 -0.0016814528868031606 1.7861659972800694 -0.1069133819137925 0.13152013255453776 -0.0158823324409491 -0.018093909037608234 0.041862977231816666 -0.017356064295914513 0.033325026160508926;
 0.2165118919946159 0.025048122254883502 2.5568210599859835 -0.054277526999080596 0.029530918206317636 -0.0718479989336103 0.23810523313393012 0.0006777152194653247 -0.03341744227509792 0.2815216092308857 0.2929302205338535 0.3987747765167433 -0.07591668197869707 0.16380295279007628 0.04067584729252661;
 -6.443406042499766 -0.004170222999371691 -0.054277526999080596 5.336177537697313 0.023192909852423227 2.590847796262571 -0.01411445211879301 -0.05868485833700976 0.006083622880218706 0.004752189122409112 0.027640278341258817 -0.03570058190490194 1.7347042703714508 -2.075388595861682 1.5046246176102478;
 0.9517297841222804 -0.0508789915148001 0.029530918206317636 0.023192909852423227 2.41508293429644 0.036852976332324844 -0.029047232959314776 0.01905746348124808 0.06496920575636564 0.2942848660635258 -0.03455045629689997 0.15139175227548626 -1.2050970337166045 2.1054307956160616 -0.18176846920047768;
 -6.663120587793526 -0.02312576814180631 -0.0718479989336103 2.590847796262571 0.036852976332324844 2.7038524691555685 -0.014517812578035158 -0.04709069812737457 -0.01418286918517522 0.16207868858285301 0.019663535862618976 -0.05112104809065309 0.6101512327685242 -1.1102850066725192 1.3741558097336746;
 0.046501715203226796 -0.0016814528868031606 0.23810523313393012 -0.01411445211879301 -0.029047232959314776 -0.014517812578035158 2.333025268656615 -0.038805047430494496 -0.06098060850601521 -0.013097439873498621 -0.07858898351667855 0.06091166475895097 -0.01683051118457727 0.009912015246835671 -0.0013208350100911521;
 0.16331808768729986 1.7861659972800694 0.0006777152194653247 -0.05868485833700976 0.01905746348124808 -0.04709069812737457 -0.038805047430494496 2.7981215445401197 0.663881356796648 0.11592301291018887 -0.013645585034644123 -0.017917979343880716 -0.02492956779833997 -0.009927038772898585 -0.03261280701300387;
 0.017292866395106996 -0.1069133819137925 -0.03341744227509792 0.006083622880218706 0.06496920575636564 -0.01418286918517522 -0.06098060850601521 0.663881356796648 0.6870409148121043 -0.03048433851667008 0.017563611453323212 -0.01373977866638831 -0.05259375864707904 -0.0066793366612343886 -0.013646942000740958;
 -0.1762731801635472 0.13152013255453776 0.2815216092308857 0.004752189122409112 0.2942848660635258 0.16207868858285301 -0.013097439873498621 0.11592301291018887 -0.03048433851667008 2.4141166829686402 -0.014415187345570159 0.04361808981133257 0.06895407016398437 0.5201150834875707 0.2499140677756766;
 -0.13003138203944958 -0.0158823324409491 0.2929302205338535 0.027640278341258817 -0.03455045629689997 0.019663535862618976 -0.07858898351667855 -0.013645585034644123 0.017563611453323212 -0.014415187345570159 3.785299624028919 0.05616716346762698 0.0331735398570363 -0.22575559116964886 -0.04770865579813756;
 0.1301892073119003 -0.018093909037608234 0.3987747765167433 -0.03570058190490194 0.15139175227548626 -0.05112104809065309 0.06091166475895097 -0.017917979343880716 -0.01373977866638831 0.04361808981133257 0.05616716346762698 2.383413566848388 -0.1374216550566227 0.09875939222871055 -0.030267792954196075;
 -4.428318296659477 0.041862977231816666 -0.07591668197869707 1.7347042703714508 -1.2050970337166045 0.6101512327685242 -0.01683051118457727 -0.02492956779833997 -0.05259375864707904 0.06895407016398437 0.0331735398570363 -0.1374216550566227 3.5826416539866637 -2.0195821681895265 0.36908429300666196;
 5.9196328756118985 -0.017356064295914513 0.16380295279007628 -2.075388595861682 2.1054307956160616 -1.1102850066725192 0.009912015246835671 -0.009927038772898585 -0.0066793366612343886 0.5201150834875707 -0.22575559116964886 0.09875939222871055 -2.0195821681895265 5.348151378402123 -0.001265745090783371;
 -4.068097853224866 0.033325026160508926 0.04067584729252661 1.5046246176102478 -0.18176846920047768 1.3741558097336746 -0.0013208350100911521 -0.03261280701300387 -0.013646942000740958 0.2499140677756766 -0.04770865579813756 -0.030267792954196075 0.36908429300666196 -0.001265745090783371 1.8713142326500014;
]
solve(n, X, P13, Q13, M13, true)
## Multiplier-1
P14 = 419*X[1]^2//250 + 209*X[1]*X[2]//200 - 501*X[1]*X[3]//5000 - 8329*X[1]*X[4]//100000 - 2233*X[1]//1000 + 803*X[2]^2//500 - 69*X[2]*X[3]//6250 + 361*X[2]*X[4]//40000 + 1961*X[2]//1000 + 2153*X[3]^2//1000 - 737*X[3]*X[4]//250000 - 5119*X[3]//1000000 + 33*X[4]^2//125 - 891*X[4]//5000 + 2621//1000
M14 = [1, X[4], X[3], X[2], X[1]]
Q14 = [2.6210951907615527 -0.08881597622139863 -0.0014455133392477456 0.9804313953372821 -1.1155421617046226;
 -0.08881597622139863 0.26415717509511766 -0.0016136888184482348 0.0046319078023843024 -0.04185656694947878;
 -0.0014455133392477456 -0.0016136888184482348 2.152591457045678 -0.004085187792103715 -0.04973075272170257;
 0.9804313953372821 0.0046319078023843024 -0.004085187792103715 1.606295537441263 0.5225613749037689;
 -1.1155421617046226 -0.04185656694947878 -0.04973075272170257 0.5225613749037689 1.6743520518617239;
]
solve(n, X, P14, Q14, M14, true)